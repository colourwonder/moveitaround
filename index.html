<!doctype html>
<html>
    <head>
        <meta charset="UTF-8" />
        <title>Plants Vs. Zombies - Flower Power</title>
        <script src="//cdn.jsdelivr.net/phaser/2.5.0/phaser.min.js"></script>
    </head>
    <body>

    <script type="text/javascript">
var game = new Phaser.Game(800, 600, Phaser.CANVAS, 'phaser-example', { preload: preload, create: create, update: update, render: render });

function preload() {

    game.load.spritesheet('zombie', 'img/hippie zombie75x168.png', 75, 168, 1);

}

var sprites;
var rip = 0;

function flipSprite(sprite) {
  // Set Anchor to the center of your sprite

  sprite.anchor.setTo(.5,.5);

// Invert scale.x to flip left/right

  sprite.scale.x *= -1;

  return(sprite)
}

function create() {

    sprites = game.add.group();


    var zombie = sprites.create(0, 0, 'zombie');
    zombie = flipSprite(zombie);

     //  This will create a new object called "cursors", inside it will contain 4 objects: up, down, left and right.
    //  These are all Phaser.Key objects, so anything you can do with a Key object you can do with these.
    cursors = game.input.keyboard.createCursorKeys();

}


function update() {

    sprites.setAll('x', 2, true, true, 1);

    sprites.forEach(checkSprite, this, true);

     //  For example this checks if the up or down keys are pressed and moves the camera accordingly.
    if (cursors.right.isDown)
    {
      game.camera.x -= 4;
    }
    if (cursors.le.isDown)
    {
      game.camera.x -= 4;
    }

}

function checkSprite(sprite) {

    try {
        if (sprite.x > game.width)
        {
            rip++;
            sprites.remove(sprite, true);
        }
    }
    catch (e)
    {
        console.log(sprite);
    }

}

function render() {

    game.debug.text("Group size: " + sprites.total, 32, 32);
    game.debug.text("Destroyed: " + rip, 32, 64);

}

    </script>

    </body>
</html>